- with_pagination = ((with_pagination.nil? ? true : with_pagination) rescue true)
- on_search = (params[:action] == "search")

#pagination-listitem
  - students.each_with_index do |student, idx|
    - unless on_search
      - student_home_url = student_path(student, :user_id => user.id, :admin_id => @admin) 
    - else
      - student_home_url = student_path(student, :user_id => student.teacher.id, :admin_id => @admin)
    .student-container.hoverable.clearfix.link{:href => student_home_url, :class => params[:query] ? "" : "pull-left"}
      = render "shared/students/cell", :student => student, :url => student_home_url    
      
    - unless on_search
      - if (idx + 1) % 4 == 0
        .clearfix

- unless on_search
  - if with_pagination
    .clearfix
    .pagination-container.ajax
      = render_pagination students, :current_page => @current_page
      .loading.hide
- else
  .clearfix
  - pagination_params ||= {}
  = render_pagination(students, {:type => 'student', :current_page => @current_page}, pagination_params)
  .loading.hide

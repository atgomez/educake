- goal ||= Goal.build_goal :trial_days_total => 10, :trial_days_actual => 9, :baseline_date => Date.today
- student ||= Student.new
- goal.build_statuses 
- id ||= 'goal-dialog'
.modal.hide.fade{:tabindex => "-1", :id => id}
  = simple_form_for(goal, :html => { :id => "goal-form#{goal.id}", :class => 'goal-form form-horizontal goal-form' }) do |f|
    .modal-header
      %button.close{"aria-hidden" => "true", "data-dismiss" => "modal", :type => "button"} &times;
      - if goal.new_record?
        %h4 Add a Goal
      - else
        %h4 Edit Goal

    .modal-body
      - if notification = f.error_notification
        .alert.alert-error.fade.in
          %a{:class => "close", 'data-dismiss' => "alert", :href => "#"} &times;
          = notification

      = f.association :curriculum, :label => "Curriculum Core"
      = f.association :subject, :label => "Subject & Standard"
      = f.input(:due_date, :as => :string, :input_html => {:class => "select-date", 
                :value => goal.due_date_string, :id => "goal_due_date#{goal.id}"})
      = f.input :accuracy, :label => "Goal % Accuracy", :input_html => {:id => "accuracy-#{goal.id}"}
      = f.input(:baseline_date, :as => :string, :input_html => {:class => "select-date", 
                :value => goal.baseline_date_string, :id => "baseline_date#{goal.id}"})
      = f.input(:baseline, :label => "Baseline % Accuracy", :input_html => {:id => "baseline-#{goal.id}"})

      .control-group.date.required
        %label.date.required.control-label{:for => "goal_baseline_date_1i"}
          %abbr{:title => "required"} *
          Trial days
        .controls
          = f.input_field(:trial_days_actual, :length => 5, :style => "width:50px")
          \/
          = f.input_field(:trial_days_total, :length => 5, :style => "width:50px")
      = f.hidden_field(:id)
      = f.hidden_field(:student_id, :value => student.id)
      
      .horizontal-bar
      
      .progress-report-container
        - idx = 1
        - goal.progresses.each do |status|
          = f.simple_fields_for(:statuses, status) do |f_status|
            %label.status-name= "Progress Report #{idx}"
            = f_status.input(:due_date, :as => :string, :input_html => {:class => "select-date", 
                  :value => status.due_date_string, :id => "goal_#{goal.id}_#{status.object_id}"}, :label => "Due Date")
            = f_status.input :accuracy, :label => "% Accuracy"
            - idx = idx + 1
            
    .modal-footer
      .submit-indicator.loading.hide

      - unless goal.new_record?
        = f.input(:is_archived, :label => "Archive Goal")
        
      %input.reset-form-button.hide{:type => "reset"}
      %button.btn{"aria-hidden" => "true", "data-dismiss" => "modal", :class => "close-dialog", :id => "btn-cancel"} Cancel
      %button.btn.btn-primary{:id => "btn-save-goal"} Save

